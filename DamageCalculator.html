<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>DamageCalculator</title>
 <style>
        body {
            background : #555
        }
        .content {
            width: 1240px;
            height : auto ;
            margin: auto;
            background: white;
            padding: 10px;
            font-size :18px;
            line-height :200%;
            float:none;
            overflow:auto ;
         }
        .leftbox {
            width:608px;
            background: white;
            float:left;
            padding: 4px;
        }
        .rightbox {
            width:608px;
            background: white;
            float:left;
            padding: 4px;
        }
        .BATK{
            width :110px;
            float :left ;
        }
		.cal_batk{
			clear:left;
			padding-top:10px;
			
		}
    </style>
  
</head>

<body>
    <form autocomplete="off">
    <form autocomplete="new-password"> <!--禁用自动填充-->
    
	<div class="content"> 
		<h3 style="font-family: 微软雅黑">Damage Calculator</h3>
   		<hr noshade="noshade"/>

   		<div class="leftbox">
    		<label id="lbl_ATKTYPE">1.选择攻击类型：</label>
        	<select id="CMB_atktype" onchange="CMB_atktype_changed()">
        	</select>
        	<br/><hr/>
        	<label id="2">2.计算基础攻击力：</label>
        	<br/>
        	<div class="BATK">
        		<label id="lbl_BATK_V1" style="font-size:14px;">V1:</label>
            	<input id="TBox_BATK_V1" type="text" style="width:100px;" onchange="check_set_BATK_Vn(1)"/>
        	</div>
        	<div class="BATK">
        		<label id="lbl_BATK_V2" style="font-size:14px;">V2:</label>
            	<input id="TBox_BATK_V2" type="text" style="width:100px;" onchange="check_set_BATK_Vn(2)"/>
        	</div>
        	<div class="BATK">
        		<label id="lbl_BATK_V3" style="font-size:14px;">V3:</label>
            	<input id="TBox_BATK_V3" type="text" style="width:100px;" onchange="check_set_BATK_Vn(3)"/>
        	</div>
        	<div class="BATK">
        		<label id="lbl_BATK_V4" style="font-size:14px">V4:</label>
            	<input id="TBox_BATK_V4" type="text" style="width:100px;" onchange="check_set_BATK_Vn(4)"/>
        	</div>
        	<div class="BATK">
        		<label id="lbl_BATK_V5" style="font-size:14px">V5:</label>
            	<input id="TBox_BATK_V5" type="text" style="width:100px;" onchange="check_set_BATK_Vn(5)"/>
        	</div>
            <div class="cal_batk">
            	<label>计算公式：</label><label id="lbl_formula">aa</label>
                <br/>
                <label>计算结果：</label><label id="lbl_BATK_result">00</label>
            </div>
            
            
            
        
    
    	</div>	
  		<div class="rightbox">
    
    	</div>
	</div> 
<script type="text/javascript">
	//
	var D_BATK = 0
	var D_BATK_V1 = 0
	var D_BATK_V2 = 0
	var D_BATK_V3 = 0
	var D_BATK_V4 = 0
	var D_BATK_V5 = 0
	
	//
    
	var Dict_atktype=new Array("航空战(轰炸机)", "航空战(鱼雷机)", "昼战反潜(轻母航战)", "昼战反潜(驱逐巡洋)", "昼战炮击(航母系)", "昼战炮击(其他)", "昼战雷击", "夜战雷击", "夜战巡洋舰炮雷合击", "夜战巡洋舰炮击", "夜战其他炮击") //攻击类型	  
	var Dict_atktype_enable_BATK = [ //决定要启用哪些变量来计算基础攻击力
            [1, 1, 0, 0, 0], //航空战(轰炸机)
            [1, 1, 0, 0, 0], //航空战(鱼雷机)
            [1, 0, 0, 0, 0], //昼战反潜(轻母航战)
            [1, 1, 0, 0, 0], //昼战反潜(驱逐巡洋)
            [1, 1, 1, 1, 1], //昼战炮击(航母系)
            [1, 0, 0, 0, 0], //昼战炮击(其他)
            [1, 0, 0, 0, 0], //昼战雷击
            [1, 0, 0, 0, 0], //夜战雷击
            [1, 1, 0, 0, 0], //夜战巡洋舰炮雷合击
            [1, 0, 0, 0, 0], //夜战巡洋舰炮击
            [1, 0, 0, 0, 0]  //夜战其他炮击
        ]
	
     var Dict_atktype_label = [ //基础攻击力的标签说明
            ["放飞机数：", "该格轰炸：", "不可用", "不可用", "不可用"],
            ["放飞机数：", "该格鱼雷：", "不可用", "不可用", "不可用"],
            ["舰船对潜：", "不可用", "不可用", "不可用", "不可用"],
            ["舰船对潜：", "深弹对潜：", "不可用", "不可用", "不可用"],
            ["火力：", "轰炸：", "鱼雷：", "对方总对空值：", "系数α(0~1)："],
            ["火力：", "不可用", "不可用", "不可用", "不可用"],
            ["鱼雷：", "不可用", "不可用", "不可用", "不可用"],
            ["鱼雷：", "不可用", "不可用", "不可用", "不可用"],
            ["火力：", "鱼雷：", "不可用", "不可用", "不可用"],
            ["火力：", "不可用", "不可用", "不可用", "不可用"],
            ["火力：", "不可用", "不可用", "不可用", "不可用"]
		]
	
	//页面加载时运行
	for (var i=0;i<Dict_atktype.length;i++){ //加载攻击类型下拉框
		var getData = Dict_atktype[i];
		document.getElementById("CMB_atktype").options.add(new Option(getData,i));
	}
	CMB_atktype_changed();
	
	//
	
	function CMB_atktype_changed(){ //下拉列表选择项改变后
		var index=document.getElementById("CMB_atktype").selectedIndex;
		select_val_to_cal_BATK(index); //根据攻击类型来设置要输入的变量V1~V5
		show_BATK_formula_and_calculate(index);//显示基础攻击力计算公式并计算
	}
	function check_set_BATK_Vn(index){ //处理文本框输入
		var tboxid = "TBox_BATK_V" + index;
		if ( document.getElementById(tboxid).value != "" ) {
			switch (index)
			{ 
				case 1:
					D_BATK_V1 = document.getElementById(tboxid).value;
					break;
				case 2:
					D_BATK_V2 = document.getElementById(tboxid).value;
					break;
				case 3:
					D_BATK_V3 = document.getElementById(tboxid).value;
					break;
				case 4:
					D_BATK_V4 = document.getElementById(tboxid).value;
					break;
				case 5:
					D_BATK_V5 = document.getElementById(tboxid).value;
					break;
			}
		}
		show_BATK_formula_and_calculate(document.getElementById("CMB_atktype").selectedIndex)
	}
	
	//
	function select_val_to_cal_BATK(CMB_atktype_i){	//根据攻击类型来设置要输入的变量
		for (var i =0;i<Dict_atktype_enable_BATK[1].length;i++){
			var id = i + 1;
			var tboxid = "TBox_BATK_V" + id;
			var labelid = "lbl_BATK_V" + id;
			if (Dict_atktype_enable_BATK[CMB_atktype_i][i] == 0) {
				document.getElementById(tboxid).disabled=true; //启用相关的input
			}
			else if (Dict_atktype_enable_BATK[CMB_atktype_i][i] == 1) {
				document.getElementById(tboxid).disabled=false; //禁用用不到的input
			}
			//设置label的文字
			document.getElementById(labelid).innerText = Dict_atktype_label[CMB_atktype_i][i];
		}
		clear_val_BATK();//每更换一次攻击类型,就清空变量的值
	//	alert(CMB_atktype_i);
	}
	function clear_val_BATK(){ //清空变量的值
		document.getElementById("lbl_BATK_result").innerText = "";
        D_BATK = 0;
        D_BATK_V1 = 0;
        D_BATK_V2 = 0;
        D_BATK_V3 = 0;
        D_BATK_V4 = 0;
        D_BATK_V5 = 0;
		document.getElementById("TBox_BATK_V1").value = "0";
		document.getElementById("TBox_BATK_V2").value = "0";
		document.getElementById("TBox_BATK_V3").value = "0";
		document.getElementById("TBox_BATK_V4").value = "0";
		document.getElementById("TBox_BATK_V5").value = "0";
	}
	function show_BATK_formula_and_calculate(CMB_atktype_i){ //计算公式可视化
		document.getElementById("lbl_formula").innerText = "";
		switch (CMB_atktype_i)
		{
			case 0: //航空战(轰炸机):LN(剩余机数 + 1) * 2 * 该格轰炸 + 25
				document.getElementById("lbl_formula").innerText = "ln( " + D_BATK_V1 + " + 1 ) × 2 × " + D_BATK_V2 + " + 25";
				BATK_Cal(0);
				break;
			case 1: //航空战(鱼雷机):LN(剩余机数 + 1) * 2 * 该格鱼雷 + 25
				document.getElementById("lbl_formula").innerText = "ln( " + D_BATK_V1 + " + 1 ) × 2 × " + D_BATK_V2 + " + 25";
				BATK_Cal(1);
				break;
			case 2: //反潜(轻母航战):	舰船对潜 / 3 + 30
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " ÷ 3";
				BATK_Cal(2);
				break;
			case 3: //反潜(驱逐巡洋):舰船对潜 / 3 + 深弹对潜 * 1.3 + 30 (有深弹); 舰船对潜 / 3 (无深弹)
				if (parseInt(document.getElementById("TBox_BATK_V2").value)==0){ //自动区分有无深弹
					document.getElementById("lbl_formula").innerText = D_BATK_V1 + " ÷ 3";
					BATK_Cal(30);
				}
				else {
					document.getElementById("lbl_formula").innerText =  D_BATK_V1 + " ÷ 3 + " + D_BATK_V2 + " × 1.3 + 30";
					BATK_Cal(31);
				}
				break;
			case 4: //炮击(航母系):(火力 + 轰炸 * 2 + 鱼雷) * MAX(0, 1 - 对方总对空值 * α / 150) + 35
				document.getElementById("lbl_formula").innerText =  "( " + D_BATK_V1 + " + " + D_BATK_V2 + " × 2 + " + D_BATK_V3 + " ) × MAX( 0 , 1 - " + D_BATK_V4 + " × " + D_BATK_V5 + " ÷ 150 ) + 35";
				BATK_Cal(4);
				break;
			case 5: //炮击(其他):火力 + 5
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + 5";
				BATK_Cal(5);
				break;
			case 6: //雷击:鱼雷 + 5
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + 5";
				BATK_Cal(6);
				break;
			case 7: //夜战雷击:鱼雷 + 10
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + 10";
				BATK_Cal(7);
				break;
			case 8: //夜战巡洋舰炮雷合击:火力 + 鱼雷 + 10
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + " + D_BATK_V2 + " + 10";
				BATK_Cal(8);
				break;
			case 9: //夜战巡洋舰炮击:火力 + 10
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + 10";
				BATK_Cal(9);
				break;
			case 10: //夜战其他炮击:火力 + 10
				document.getElementById("lbl_formula").innerText = D_BATK_V1 + " + 10";
				BATK_Cal(10);
				break;
		}
	}
	function BATK_Cal(CMB_atktype_i){ //计算基础攻击力
		document.getElementById("lbl_BATK_result").innerText = "";
		switch (CMB_atktype_i)
		{
			case 0: //航空战(轰炸机)
				D_BATK = Math.log(Number(D_BATK_V1) + 1) * 2 * Number(D_BATK_V2) + 25;
				break;
			case 1: //航空战(鱼雷机)
				D_BATK = Math.log(Number(D_BATK_V1) + 1) * 2 * Number(D_BATK_V2) + 25;
				break;
			case 2: //反潜(轻母航战)
				D_BATK = Number(D_BATK_V1) / 3;
				break;
			case 30: //反潜(驱逐巡洋)无深弹
				D_BATK = Number(D_BATK_V1) / 3;
				break;
			case 31: //反潜(驱逐巡洋)有深弹
				D_BATK = Number(D_BATK_V1) / 3 + Number(D_BATK_V2) * 1.3 + 30;
				break;
			case 4: //炮击(航母系)
			
				break;
			case 5:
			
				break;
			case 6:
			
				break;
			case 7:
			
				break;
			case 8:
			
				break;
			case 9:
			
				break;
			case 10:
			
				break;
		}
		document.getElementById("lbl_BATK_result").innerText = D_BATK;
	}
	
	

</script>
</body>
</html>
